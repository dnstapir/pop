# manually maintained

cli:
   tem:
      url:	https://127.0.0.1:9099/api/v1
      tlsurl:	https://127.0.0.1:9098/api/v1
      apikey:	be-nice-to-a-bad-tempered-tapir
   dtm:
      tlsurl:	https://127.0.0.1:9090/

apiserver:
   key:		be-nice-to-a-bad-tempered-tapir
   address:	127.0.0.1:9099
   tlsaddress:	127.0.0.1:9098

server:
   listen:	127.0.0.1
   port:	9097
   upstreams:	[ nsa.johani.org:53 ]
   downstreams:	[ 127.0.0.1:9999 ]  	# unbound
   xferzones:	[ ]  # not useful for TAPIR
   mapzones:	[ ]  # likely not useful for TAPIR
   slicezones:	[ rpz.threat-feed.com ]

dnsengine:
   addresses:	127.0.0.1:5359

service:
   name:		foobar
   filter:		dnssec+zonemd
   reset_soa_serial:	true
   verbose:		true
   debug:		true
   refresh:
      active:	true

sources:
   active:	[ tapir, local, localwhitelist ]
   tapir:
      type:	mqtt
      content:	intelligence
   local:
      type:	file
      content:	intelligence
      format:	tapir-tags-v1
      filename:	/etc/dnstapir/local-feed.txt
   localwhitelist:
      type:	file	
      content:	whitelist
      format:	domains		# domains | dawg
      filename:	/etc/dnstapir/local-whitelist.txt
   inactive_source:
      type:	axfr
      content:	intelligence
      format:	rpz
      zone:	rpz.zone
      upstream:	10.1.2.3:53
      tsig:	...

redirects:
   tapir:	landing-page.dnstapir.se
   police:	www.polisen.se

# known actions: passthru, drop, nxdomain, nodata, tapir, police

policies:
   default:
      taglimit:		3	# i.e. 4 TAPIR tags and you're out
      tagaction:	nxdomain
      feedlimit:	1	# i.e. name present in multiple feeds will be blocked
      feedaction:	nodata
      hardblock:	[ barnporr-feed ]	# name present in one of these is always blocked
      hardaction:	police
   johani:
      taglimit:		0	# i.e. 1 TAPIR tag and you're out
      tagaction:	nxdomain
      feedlimit:	0	# i.e. name present in any feeds will be blocked
      feedaction:	nodata
      hardblock:	[ barnporr-feed ]	# name present in one of these is always blocked
      hardaction:	police

certs:
   certdir:	/etc/dnstapir/certs
   cacertfile:	/etc/dnstapir/certs/axfr.netCA.crt
   tem:
      cert:	/etc/dnstapir/certs/tem.crt
      key:	/etc/dnstapir/certs/tem.key
   tapir-cli:
      cert:	/etc/dnstapir/certs/tem.crt
      key:	/etc/dnstapir/certs/tem.key

log:
   file:	/var/log/dnstapir/tem.log
